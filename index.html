<head>
  <style>
    #board {
      display: grid;
      grid-template-columns: repeat(10, 90px);
      grid-template-rows: repeat(5, 90px);
      gap: 4px;
      margin: 20px auto;
      width: max-content;
    }
    .cell {
      background-color: lightgray;
      border: 1px solid #999;
      width: 90px;
      height: 90px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 12px;
      position: relative;
      flex-direction: column;
      cursor: pointer;
    }
    .player {
      border-radius: 50%;
      width: 20px;
      height: 20px;
      position: absolute;
    }
    .draw-card {
      background-color: #d4e3fd !important;
    }
    .ladder {
      background-color: #d4fdd4 !important;
    }
    .chute {
      background-color: #fdd4d4 !important;
    }
  $1
    .info-button {
      margin-top: 4px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 14px;
    }
    .tooltip-content {
      visibility: hidden;
      background-color: #333;
      color: #fff;
      text-align: left;
      padding: 8px;
      border-radius: 6px;
      position: absolute;
      z-index: 1;
      top: 100%;
      left: 0;
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 12px;
      width: 200px;
    }
    .info-tooltip:hover .tooltip-content {
      visibility: visible;
      opacity: 1;
    }
</head>
<body>
  <h1>Paths of Justice</h1>
  <div id="board"></div>
  <div style="margin-top: 20px;">
    <p>Player position: <span id="position">1</span></p>
    <p id="turnDisplay">ðŸŽ¯ Player 1's turn</p>
    <p id="diceResult"></p>
    <button onclick="rollDice()">Roll Dice</button>
    <button onclick="movePlayer()">Move Player</button>
    <div class="card" id="card" style="display:none;"></div>
  </div>

<script>
  const goodSound = new Audio('https://www.soundjay.com/buttons/sounds/button-09.mp3');
  const badSound = new Audio('https://www.soundjay.com/buttons/sounds/button-10.mp3');

  window.onload = function () {
    const board = document.getElementById('board');
    const positionDisplay = document.getElementById('position');
    const card = document.getElementById('card');

    let playerPositions = [1, 1, 1, 1];
    let currentPlayer = 0;
    let pendingRoll = null;
    let activePlayers = [false, false, false, false];
    const playerColors = ['gold', 'red', 'blue', 'green'];

    const ladders = { 4: 18, 11: 26, 29: 39 };
    const chutes = { 22: 11, 36: 17, 45: 31 };

    function movePlayerBy(amount) {
      let newPos = playerPositions[currentPlayer] + amount;
      newPos = Math.max(1, Math.min(50, newPos));
      playerPositions[currentPlayer] = newPos;
      positionDisplay.textContent = newPos;
      renderPlayer();
      if (amount > 0) goodSound.play();
      if (amount < 0) badSound.play();
    }

    for (let i = 1; i <= 50; i++) {
      const cell = document.createElement('div');
      cell.className = 'cell';
      cell.id = 'cell-' + i;

      if (i === 1) {
        cell.classList.add('start');
        cell.innerHTML = `<div>1<br>Start Your Future</div>`;
      } else if (i === 50) {
        cell.classList.add('end');
        cell.innerHTML = `<div>50<br>You Made the Right Choices</div>`;
      } else {
        cell.innerHTML = `<div>${i}</div>`;
      }

      if (ladders[i]) cell.classList.add('ladder');
      if (chutes[i]) cell.classList.add('chute');

      if (i % 3 === 0) {
        cell.classList.add('draw-card');

        const infoButton = document.createElement('button');
        infoButton.className = 'info-button';
        infoButton.textContent = 'â„¹ï¸';

        const tooltip = document.createElement('div');
        tooltip.className = 'tooltip-content';
        tooltip.textContent = 'This is a life event. Draw a card and see what happens.';

        const wrapper = document.createElement('div');
        wrapper.className = 'info-tooltip';
        wrapper.appendChild(infoButton);
        wrapper.appendChild(tooltip);

        infoButton.onclick = (e) => {
          e.stopPropagation();
          const options = [
            { text: 'You found a job training program. Move ahead 2 spaces.', effect: () => movePlayerBy(2) },
            { text: 'You got caught with a bad crowd. Go back 1 space.', effect: () => movePlayerBy(-1) },
            { text: 'A mentor helped you stay focused. Move ahead 1 space.', effect: () => movePlayerBy(1) }
          ];
          const choice = options[Math.floor(Math.random() * options.length)];
          tooltip.textContent = choice.text;
          tooltip.style.visibility = tooltip.style.visibility === 'visible' ? 'hidden' : 'visible';
          tooltip.style.opacity = tooltip.style.opacity === '1' ? '0' : '1';
          choice.effect();
        };

        cell.appendChild(wrapper);
      }

      board.appendChild(cell);
    }

    function renderPlayer() {
      document.querySelectorAll('.player').forEach(p => p.remove());
      playerPositions.forEach((pos, index) => {
        if (activePlayers[index]) {
          const currentCell = document.getElementById('cell-' + pos);
          const token = document.createElement('div');
          token.className = 'player';
          token.style.backgroundColor = playerColors[index];
          token.title = 'Player ' + (index + 1);
          currentCell.appendChild(token);
        }
      });
    }

    function joinGame(playerIndex) {
      if (activePlayers[playerIndex]) {
        alert('Player ' + (playerIndex + 1) + ' has already joined.');
        return;
      }
      activePlayers[playerIndex] = true;
      alert('Player ' + (playerIndex + 1) + ' joined the game!');
      renderPlayer();
    }

    function rollDice() {
      card.style.display = 'none';
      if (!activePlayers.includes(true)) {
        alert('No players have joined the game!');
        return;
      }
      const roll = Math.floor(Math.random() * 6) + 1;
      pendingRoll = roll;
      document.getElementById('diceResult').textContent = 'ðŸŽ² Rolled: ' + roll;
    }

    function movePlayer() {
      if (pendingRoll === null) {
        alert('Please roll the dice first!');
        return;
      }

      let currentPos = playerPositions[currentPlayer];
      let nextPos = currentPos + pendingRoll;
      if (nextPos > 50) nextPos = 50;

      if (ladders[nextPos]) {
        nextPos = ladders[nextPos];
        alert('ðŸŸ¢ You climbed a ladder!');
      } else if (chutes[nextPos]) {
        nextPos = chutes[nextPos];
        alert('ðŸ”´ You slid down a chute!');
      }

      playerPositions[currentPlayer] = nextPos;
      positionDisplay.textContent = playerPositions[currentPlayer];
      renderPlayer();

      pendingRoll = null;

      do {
        currentPlayer = (currentPlayer + 1) % 4;
      } while (!activePlayers[currentPlayer]);

      document.getElementById('turnDisplay').textContent = 'ðŸŽ¯ Player ' + (currentPlayer + 1) + "'s turn";
    }

    function resetGame() {
      playerPositions = [1, 1, 1, 1];
      currentPlayer = 0;
      activePlayers = [false, false, false, false];
      renderPlayer();
      positionDisplay.textContent = 1;
      card.style.display = 'none';
      document.getElementById('diceResult').textContent = '';
      document.getElementById('turnDisplay').textContent = 'ðŸŽ¯ Player 1\'s turn';
    }

    window.joinGame = joinGame;
    window.rollDice = rollDice;
    window.movePlayer = movePlayer;
    window.resetGame = resetGame;

    renderPlayer();
  }
</script>
</body>
